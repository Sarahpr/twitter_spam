# This script calculates the percent of tweets that are spam in each hour of the
# day and spits out a datafile with that percentage.

# Total tweets per hour:
tweets_per_hour = [{ "_id" : 0, "value" : 27403 },
{ "_id" : 0.5, "value" : 25887 },
{ "_id" : 1, "value" : 29315 },
{ "_id" : 1.5, "value" : 28210 },
{ "_id" : 2, "value" : 31333 },
{ "_id" : 2.5, "value" : 29172 },
{ "_id" : 3, "value" : 31463 },
{ "_id" : 3.5, "value" : 28233 },
{ "_id" : 4, "value" : 28791 },
{ "_id" : 4.5, "value" : 24240 },
{ "_id" : 5, "value" : 24350 },
{ "_id" : 5.5, "value" : 20795 },
{ "_id" : 6, "value" : 21692 },
{ "_id" : 6.5, "value" : 19278 },
{ "_id" : 7, "value" : 20328 },
{ "_id" : 7.5, "value" : 16973 },
{ "_id" : 8, "value" : 18184 },
{ "_id" : 8.5, "value" : 15968 },
{ "_id" : 9, "value" : 17334 },
{ "_id" : 9.5, "value" : 16316 },
{ "_id" : 10, "value" : 18615 },
{ "_id" : 10.5, "value" : 17501 },
{ "_id" : 11, "value" : 20825 },
{ "_id" : 11.5, "value" : 19881 },
{ "_id" : 12, "value" : 23025 },
{ "_id" : 12.5, "value" : 22783 },
{ "_id" : 13, "value" : 25814 },
{ "_id" : 13.5, "value" : 25890 },
{ "_id" : 14, "value" : 27414 },
{ "_id" : 14.5, "value" : 26114 },
{ "_id" : 15, "value" : 28440 },
{ "_id" : 15.5, "value" : 27246 },
{ "_id" : 16, "value" : 28622 },
{ "_id" : 16.5, "value" : 27450 },
{ "_id" : 17, "value" : 28815 },
{ "_id" : 17.5, "value" : 27540 },
{ "_id" : 18, "value" : 29671 },
{ "_id" : 18.5, "value" : 28425 },
{ "_id" : 19, "value" : 29503 },
{ "_id" : 19.5, "value" : 29204 },
{ "_id" : 20, "value" : 29775 },
{ "_id" : 20.5, "value" : 27635 },
{ "_id" : 21, "value" : 27752 },
{ "_id" : 21.5, "value" : 27266 },
{ "_id" : 22, "value" : 28274 },
{ "_id" : 22.5, "value" : 26941 },
{ "_id" : 23, "value" : 26689 },
{ "_id" : 23.5, "value" : 24585 }]

spam_per_hour = [{ "_id" : 0, "value" : 2019 },
{ "_id" : 0.5, "value" : 1874 },
{ "_id" : 1, "value" : 2147 },
{ "_id" : 1.5, "value" : 2037 },
{ "_id" : 2, "value" : 2201 },
{ "_id" : 2.5, "value" : 1793 },
{ "_id" : 3, "value" : 2062 },
{ "_id" : 3.5, "value" : 1853 },
{ "_id" : 4, "value" : 1872 },
{ "_id" : 4.5, "value" : 1822 },
{ "_id" : 5, "value" : 1703 },
{ "_id" : 5.5, "value" : 1464 },
{ "_id" : 6, "value" : 1832 },
{ "_id" : 6.5, "value" : 1629 },
{ "_id" : 7, "value" : 2156 },
{ "_id" : 7.5, "value" : 1933 },
{ "_id" : 8, "value" : 2336 },
{ "_id" : 8.5, "value" : 1968 },
{ "_id" : 9, "value" : 2062 },
{ "_id" : 9.5, "value" : 2076 },
{ "_id" : 10, "value" : 2455 },
{ "_id" : 10.5, "value" : 2220 },
{ "_id" : 11, "value" : 2633 },
{ "_id" : 11.5, "value" : 2600 },
{ "_id" : 12, "value" : 2488 },
{ "_id" : 12.5, "value" : 2836 },
{ "_id" : 13, "value" : 2737 },
{ "_id" : 13.5, "value" : 3439 },
{ "_id" : 14, "value" : 3318 },
{ "_id" : 14.5, "value" : 2351 },
{ "_id" : 15, "value" : 2756 },
{ "_id" : 15.5, "value" : 2334 },
{ "_id" : 16, "value" : 2625 },
{ "_id" : 16.5, "value" : 2478 },
{ "_id" : 17, "value" : 2895 },
{ "_id" : 17.5, "value" : 2241 },
{ "_id" : 18, "value" : 2290 },
{ "_id" : 18.5, "value" : 2224 },
{ "_id" : 19, "value" : 2152 },
{ "_id" : 19.5, "value" : 2047 },
{ "_id" : 20, "value" : 2285 },
{ "_id" : 20.5, "value" : 1864 },
{ "_id" : 21, "value" : 2072 },
{ "_id" : 21.5, "value" : 2238 },
{ "_id" : 22, "value" : 2430 },
{ "_id" : 22.5, "value" : 2160 },
{ "_id" : 23, "value" : 1966 },
{ "_id" : 23.5, "value" : 1958 }]

spam_percent = []
for i in range(len(tweets_per_hour)):
    if spam_per_hour[i]['_id'] == tweets_per_hour[i]['_id']:
        spam_percent.append([spam_per_hour[i]['_id'], spam_per_hour[i]['value']/float(tweets_per_hour[i]['value'])])
    else:
        raise(Exception)

with open('spam_per_hour.csv', 'w') as outfile:
    outfile.write('hour,spam_percent\n')
    for x in spam_percent:
        outfile.write(str(x[0]) + ',' + str(x[1]) + '\n')